[{"path":"/articles/DiffSegR.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"DiffSegR","text":"Gaining global picture gene regulation requires detailed knowledge transcriptome along enzymatic RNA-binding activities shape . Hence, several RNA-Seq-based strategies recently developed decipher complexity. However, tools developed count abundance sequencing reads along annotated regions (typically genes) therefore neglect un-annotated regions may lead inaccurate expression measures poorly annotated regions. context differential expression analysis, regulations genes result local changes \\(\\log_2\\) fold change (\\(\\log_2\\)-FC) along genome, .e differential transcription profile. Therefore, one can use multiple changepoint detection algorithm FPOP (Maidstone et al. 2017, doi:10.1007/s11222-016-9636-3) delineate boundaries differentially expressed regions without relying pre-existing annotations. present DiffSegR, identify--annotate tool implements strategy allow systematic discovery transcriptomic differences two biological conditions RNA-Seq experiment. DiffSegR package includes following steps: Computation coverages \\(\\log_2\\)-FC per-base bam files ; Summarize differential transcription landscape, .e. () identify segments along genome \\(\\log_2\\)-FC per-base (ii) count reads overlapping ; Use counts measures expression abundance segments differential expression analysis ; Annotate differential expressed regions (DERs) ; Visualize DERs.","code":""},{"path":[]},{"path":"/articles/DiffSegR.html","id":"foreword","dir":"Articles","previous_headings":"Quick Start","what":"Foreword","title":"DiffSegR","text":"RNA-Seq dataset (SRA046998) used purposes Quick Start evaluated differences Arabidopsis thaliana chloroplast RNA metabolism wild type (wt) null mutant chloroplast-targeted \\(3'\\to5'\\) exoribonuclease polynucleotide phosphorylase (pnp1-1). conditions contain two biological replicates. diluted set reads overlapping positions 71950 78500 chloroplast genome kept minimal dataset example.","code":""},{"path":"/articles/DiffSegR.html","id":"setup","dir":"Articles","previous_headings":"Quick Start","what":"Setup","title":"DiffSegR","text":"First, create working directory host files produced DiffSegR analysis (coverages, results). , save sample information use Quick Start section text file. practice, one can create working directory write text file hand. sample information file needs include following columns: sample : identifier sample ; condition : identifier condition ; replicate : identifier replicate ; bam : path bam file (.bam) ; coverage : path coverage file (.rds). Note: Coverages computed internally DiffSegR bam files saved rds format location specified user (coverage).","code":"working_directory <- \"./DIFFSEGR_TEST\" dir.create(working_directory, showWarnings = FALSE) #- create sample information table --------------------------------------------# sample_info <- data.frame(   sample    = c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"),   condition = rep(c(\"pnp1_1\", \"wt\"), each = 2),   replicate = rep(1:2,2),   bam       = sapply(     c(\"pnp1_1_1_ChrC_71950_78500.bam\",        \"pnp1_1_2_ChrC_71950_78500.bam\",       \"wt_1_ChrC_71950_78500.bam\",       \"wt_2_ChrC_71950_78500.bam\"     ),     function(bam) system.file(\"extdata\", bam, package = \"DiffSegR\")   ),   coverage  = file.path(     working_directory,     paste0(c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"), \".rds\")   ) ) #- save sample information table ----------------------------------------------#  write.table(   sample_info,    file.path(working_directory, \"sample_info.txt\") ) #- display sample information table -------------------------------------------# knitr::kable(sample_info, row.names = FALSE)"},{"path":"/articles/DiffSegR.html","id":"analysis","dir":"Articles","previous_headings":"Quick Start","what":"Analysis","title":"DiffSegR","text":"Now, present basic use main functions DiffSegR package. analysis carried 4 logical cores. parameter can modified user according resources disposal.","code":"library(DiffSegR) nb_threads = 4"},{"path":"/articles/DiffSegR.html","id":"step-1-computation-of-coverages-and-log_2-fc-per-base-from-bam-files","dir":"Articles","previous_headings":"Quick Start > Analysis","what":"Step 1: Computation of coverages and \\(\\log_2\\)-FC per-base from bam files","title":"DiffSegR","text":"loadData(): builds coverages bam files within locus specified user. focus positions 71950 78500 chloroplast genome (ChrC). reads stranded (stranded = TRUE), function builds one coverage profile per-strand replicate compared biological conditions. default heuristic used compute coverages geometric mean 5’ 3’ ends aligned reads (coverageType = \"average\") ; transforms coverages \\(\\log_2\\)-FC per-base (one strand). reference biological condition specified user set denominator (referenceCondition = \"wt\") ; returns coverages \\(\\log_2\\)-FC per-base list run-length encoding objects. Note: coverages already computed, set fromBam = FALSE load directly specified rds files.","code":"data <- loadData(   sampleInfo   = file.path(working_directory,\"sample_info.txt\"),   locus        = list(     seqid      = \"ChrC\",      chromStart = 71950,      chromEnd   = 78500   ),   referenceCondition = \"wt\",   stranded           = TRUE,   fromBam            = TRUE,   nbThreads          = nb_threads ) #> building coverage profiles ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 4                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 3' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid1267558 ...       || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24249 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21098 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17531 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14066 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 4                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 5' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid1267558 ...       || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24251 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21088 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17520 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14060 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #> building log2-FC per-base ... #> finished in 1.9676342010498 secs  print(data) #> $coverages #> $coverages$plus #> $coverages$plus$pnp1_1_1 #> numeric-Rle of length 6551 with 5255 runs #>   Lengths:       86        1        3        1 ...        1        1       10 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$plus$pnp1_1_2 #> numeric-Rle of length 6551 with 5209 runs #>   Lengths:       89        1        2        1 ...        5        2       30 #>   Values : 0.000000 0.732051 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$plus$wt_1 #> numeric-Rle of length 6551 with 4610 runs #>   Lengths:       46        1       15        1 ...       23        1       14 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$plus$wt_2 #> numeric-Rle of length 6551 with 4601 runs #>   Lengths:       57        1       26        1 ...       22        1        2 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #>  #> $coverages$minus #> $coverages$minus$pnp1_1_1 #> numeric-Rle of length 6551 with 526 runs #>   Lengths:       31        1       68        1 ...        6        1        1 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$minus$pnp1_1_2 #> numeric-Rle of length 6551 with 585 runs #>   Lengths:      406        1       42        1 ...        2        1        1 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$minus$wt_1 #> numeric-Rle of length 6551 with 463 runs #>   Lengths:      427        1       83        1 ...        4        1        2 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$minus$wt_2 #> numeric-Rle of length 6551 with 544 runs #>   Lengths:      458        1       63        1 ...        1       18        1 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.414214 0.000000 0.732051 #>  #>  #>  #> $log2FoldChange #> $log2FoldChange$plus #> numeric-Rle of length 6551 with 6004 runs #>   Lengths:         46          1         10 ...          1          2 #>   Values :  0.0000000 -0.2500000  0.0000000 ...  -0.250000   0.000000 #>  #> $log2FoldChange$minus #> numeric-Rle of length 6551 with 1239 runs #>   Lengths:           31            1           68 ...            1            1 #>   Values :         0.00         0.25         0.00 ...  5.00000e-01 -3.96241e-01 #>  #>  #> $locus #> GRanges object with 1 range and 0 metadata columns: #>       seqnames      ranges strand #>          <Rle>   <IRanges>  <Rle> #>   [1]     ChrC 71950-78500      * #>   ------- #>   seqinfo: 1 sequence from an unspecified genome; no seqlengths #>  #> $stranded #> [1] TRUE #>  #> $sampleInfo #>                                 sample condition replicate #> pnp1_1_1_ChrC_71950_78500.bam pnp1_1_1    pnp1_1         1 #> pnp1_1_2_ChrC_71950_78500.bam pnp1_1_2    pnp1_1         2 #> wt_1_ChrC_71950_78500.bam         wt_1        wt         1 #> wt_2_ChrC_71950_78500.bam         wt_2        wt         2 #>                                                                                                                    bam #> pnp1_1_1_ChrC_71950_78500.bam /tmp/Rtmp1z65jM/temp_libpath12df1321daf8d/DiffSegR/extdata/pnp1_1_1_ChrC_71950_78500.bam #> pnp1_1_2_ChrC_71950_78500.bam /tmp/Rtmp1z65jM/temp_libpath12df1321daf8d/DiffSegR/extdata/pnp1_1_2_ChrC_71950_78500.bam #> wt_1_ChrC_71950_78500.bam         /tmp/Rtmp1z65jM/temp_libpath12df1321daf8d/DiffSegR/extdata/wt_1_ChrC_71950_78500.bam #> wt_2_ChrC_71950_78500.bam         /tmp/Rtmp1z65jM/temp_libpath12df1321daf8d/DiffSegR/extdata/wt_2_ChrC_71950_78500.bam #>                                                   coverage #> pnp1_1_1_ChrC_71950_78500.bam ./DIFFSEGR_TEST/pnp1_1_1.rds #> pnp1_1_2_ChrC_71950_78500.bam ./DIFFSEGR_TEST/pnp1_1_2.rds #> wt_1_ChrC_71950_78500.bam         ./DIFFSEGR_TEST/wt_1.rds #> wt_2_ChrC_71950_78500.bam         ./DIFFSEGR_TEST/wt_2.rds #>  #> $referenceCondition #> [1] \"wt\""},{"path":"/articles/DiffSegR.html","id":"setp-2-summarizing-the-differential-transcription-landscape","dir":"Articles","previous_headings":"Quick Start > Analysis","what":"Setp 2: Summarizing the differential transcription landscape","title":"DiffSegR","text":"segmentation(): calls fpopw::Fpop_w(), changepoint detection mean Gaussian signal approach, \\(\\log_2\\)-FC per-base strands retrieve segments boundaries (changepoints). hyperparameter \\(\\alpha\\) specified user controls number returned segments. number changepoints decreasing function \\(\\alpha\\). default alpha=2. segments stored GenomicRanges object. calls Rsubread::featureCounts() assigns segments mapped reads replicate biological condition. read allowed assigned one feature found overlap one feature. Rsubread::featureCounts() ends building count matrix. returns segments associated count matrix SummarizedExperiment object. positions 71950 78500 chloroplast genome, segmentation() returns 17 segments forward (+) strand 52 segments reverse (-) strand. Segment coordinates associated counts can retrieved using respectively SummarizedExperiment::rowRanges SummarizedExperiment::assay accessors.","code":"SExp <- segmentation(   data                   = data,    nbThreadsFeatureCounts = nb_threads,   outputDirectory        = working_directory ) #> changepoint detection on ChrC 71950 78500 plus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_plus.pdf #> changepoint detection on ChrC 71950 78500 minus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_minus.pdf #> finished in 1.29815220832825 secs #> counting ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 4                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : counted                                          || #> ||   Min overlapping bases : 1                                                || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid1267558 ...       || #> ||    Features : 69                                                           || #> ||    Meta-features : 69                                                      || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24260 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21100 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17533 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14070 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #> finished in 0.333721399307251 secs #- number of segments found ---------------------------------------------------#  SummarizedExperiment::strand(SExp) #> factor-Rle of length 69 with 2 runs #>   Lengths: 17 52 #>   Values :  +  - #> Levels(3): + - * #- display first five segments ------------------------------------------------# segment_coordinates <- as.data.frame(SummarizedExperiment::rowRanges(SExp)) knitr::kable(segment_coordinates[1:5, colnames(segment_coordinates)%in%c(   \"seqnames\",   \"start\",   \"end\",   \"width\",   \"strand\") ]) #- display counts associated to first five segments ---------------------------# counts <- SummarizedExperiment::assay(SExp) knitr::kable(counts[1:5,])"},{"path":"/articles/DiffSegR.html","id":"step-3-differential-expression-analysis-dea","dir":"Articles","previous_headings":"Quick Start > Analysis","what":"Step 3: Differential expression analysis (DEA)","title":"DiffSegR","text":"dea() function takes input recently built SummarizedExperiment object calls DESeq2 test line, .e. segment, difference expression two compared biological conditions. control resulting p-values using Benjamini–Hochberg procedure level significanceLevel = 1e-2. Note: default sample-specific size factors computed DESeq2. can overwritten user. example, sample-specific size factors weight sizeFactors = rep(1,4). Regions differentially expressed (DERs) set rejectedHypotheses = TRUE. example, dea() returns 39 DERs.","code":"dds <- dea(   data              = data,   SExp              = SExp,   design            = ~ condition,   sizeFactors       = rep(1,4),   significanceLevel = 1e-2 ) #>   > differential expression analysis ... #> renaming the first element in assays to 'counts' #> gene-wise dispersion estimates #> mean-dispersion relationship #> final dispersion estimates #>   >  multiple testing correction ... #>   >  normalize denoised log2-FC and coverage ... #- number of DERs -------------------------------------------------------------# DERs <- dds[SummarizedExperiment::mcols(dds)$rejectedHypotheses,] length(DERs) #> [1] 39 #- display first five DERs by position ----------------------------------------# DERs <- as.data.frame(SummarizedExperiment::rowRanges(DERs)) knitr::kable(DERs[1:5, colnames(DERs)%in%c(   \"seqnames\",   \"start\",   \"end\",   \"width\",   \"strand\",   \"log2FoldChange\",   \"padj\") ])"},{"path":"/articles/DiffSegR.html","id":"step-4-annotate-the-ders","dir":"Articles","previous_headings":"Quick Start > Analysis","what":"Step 4: Annotate the DERs","title":"DiffSegR","text":"annotateNearest() relies user specified annotations gff3 gtf format annotate DERs found DEA. Seven classes labels translate relative positions DER closest annotation(s): antisense; upstream; downstream; inside; overlapping 3’; overlapping 5’; overlapping 5’, 3’.","code":"exons_path <- system.file(  \"extdata\",   \"TAIR10_ChrC_exon.gff3\",   package = \"DiffSegR\" ) annotated_DERs <- annotateNearest(    data        = data,    dds         = dds,    annotations = exons_path,    select      = c(\"seqnames\", \"start\", \"end\", \"width\", \"strand\",       \"description\", \"distance\", \"Parent\", \"log2FoldChange\", \"pvalue\"),    orderBy     = \"pvalue\" ) #>  > loading annotations from /tmp/Rtmp1z65jM/temp_libpath12df1321daf8d/DiffSegR/extdata/TAIR10_ChrC_exon.gff3 ... #>  > annotate differential expressed regions ... knitr::kable(annotated_DERs, row.names = FALSE, digits = 3)"},{"path":"/articles/DiffSegR.html","id":"step-5-visualizing-the-ders","dir":"Articles","previous_headings":"Quick Start > Analysis","what":"Step 5: Visualizing the DERs","title":"DiffSegR","text":"export() saves strands DERs, -DERs, segmentation, coverages log2-FC per-base formats readable (bedGraph, gff3) genome viewers like Integrative Genome Viewer (IGV) (Robison et al. 2011). IGV, export() also creates IGV sessiong xml format allows loading tracks one click. tracks top bottom stand : (log2-Cov plus) mean coverages log scale forward strand biological conditions interest. , blue line red line stand wt pnp1-1 conditions, respectively ; (log2-FC plus) \\(\\log_2\\)-FC per-base pnp1-1 (numerator) wt (denominator) forward strand. straight horizontal line zero indicator. \\(\\log_2\\)-FC per-base zero indicator line, suggests -regulation -regulation pnp1-1 compare wt, respectively. \\(\\log_2\\)-FC per-base displayed changepoints positions (vertical blue lines) mean segment (horizontal blue lines connect two changepoints) ; (DiffSegR plus) results DEA forward strand. -regulated regions appear green. -regulated regions appear purple. -DERs appear grey ; (annotations) features provided user interpetations. Symmetrically, rest tracks correspond data reverse strand. DiffSegR output positions 76,990 78,248 chloroplast genome. session loaded IGV 2.12.3 Linux.","code":"ChrC_path  <- system.file(  \"extdata\",   \"TAIR10_ChrC.fa\",   package = \"DiffSegR\" ) export(  data            = data,  dds             = dds,   outputDirectory = working_directory,  genome          = ChrC_path,  annotation      = exons_path,  select          = c(\"log2FoldChange\", \"pvalue\", \"padj\") )  #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: 'BiocGenerics' #> The following objects are masked from 'package:stats': #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from 'package:base': #>  #>     anyDuplicated, append, as.data.frame, basename, cbind, colnames, #>     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep, #>     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget, #>     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank, #>     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply, #>     union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: 'S4Vectors' #> The following objects are masked from 'package:base': #>  #>     expand.grid, I, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb"},{"path":[]},{"path":"/articles/DiffSegR.html","id":"exploring-more-segmentations","dir":"Articles","previous_headings":"Advanced uses","what":"Exploring more segmentations","title":"DiffSegR","text":"visual inspection, one can disagree segmentation \\(\\log_2\\)-FC proposed DiffSegR. can happen spurious changepoints, resulting -segmentation \\(\\log_2\\)-FC, seems added. case often useful explore several different segmentations order choose suitable hyperparameter \\(\\alpha\\) value. explore reachable segmentations 1 Kmax segments, one can pass segmentNeighborhood = TRUE specify value Kmax segmentation(). step can time consuming. grid search approach also implemented DiffSegR (see gridSearch alphas parameters segmentation()). figures showing path reachable segmentations Kmax segments log2-FC reverse forward strands accessible working directory name all_models_minus.rds all_models_plus.rds. good practice select robust segmentation. Visually equivalent pick elbow curve. example can select \\(\\log(\\alpha)=2.1\\) \\(\\alpha=4.28\\) symbolized red line. Setting alpha=4 segmentation() leads 11 segments reverse strand. Path reachable segmentations 50 segments log2-FC reverse strand. Corresponding alpha values log scale can read X-axis.","code":"SExp <- segmentation(   data                   = data,    nbThreadsFeatureCounts = nb_threads,   outputDirectory        = working_directory,   segmentNeighborhood    = TRUE,   Kmax = 50,   alpha = 4 ) #> changepoint detection on ChrC 71950 78500 plus ... #>   > exploring models using segment neighborhood ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_plus.pdf #> changepoint detection on ChrC 71950 78500 minus ... #>   > exploring models using segment neighborhood ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_minus.pdf #> finished in 0.649417877197266 secs #> counting ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 4                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : counted                                          || #> ||   Min overlapping bases : 1                                                || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid1267558 ...       || #> ||    Features : 28                                                           || #> ||    Meta-features : 28                                                      || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24260 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21100 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17533 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14070 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #> finished in 0.251551628112793 secs"},{"path":"/articles/DiffSegR.html","id":"post-hoc-inference","dir":"Articles","previous_headings":"Advanced uses","what":"Post hoc inference","title":"DiffSegR","text":"result DEA correspond user expected, may tend snoop data eventually select subset regions interest. instance common usage define threshold absolute log2-FC per-region. order keep rigorous statistical guarantee, DiffSegR uses post-hoc procedure control joint Family Wise Error Rate (jFWER) selected subset regions. use post hoc inference one specify : decision rule, .e predicate function returns single TRUE FALSE region applied meets conditions defined predicate. criteria used predicate defined region SummarizedExperiment::mcols(dds). , predicate = function(x) 2^abs(x$log2FoldChange)>2 ; expected minimum true positive rate returned set rejected regions. , postHoc_tpRateThreshold = 0.95 ; significance level test procedure. , postHoc_significanceLevel = 0.05.","code":"dds <- dea(   data                      = data,   SExp                      = SExp,   design                    = ~ condition,   sizeFactors               = rep(1,4),   predicate                 = function(x) 2^abs(x$log2FoldChange)>2,   postHoc_significanceLevel = 0.05,   postHoc_tpRateThreshold   = 0.95 ) #>   > differential expression analysis ... #> renaming the first element in assays to 'counts' #> gene-wise dispersion estimates #> mean-dispersion relationship #> final dispersion estimates #>   >  multiple testing correction ... #>   >  normalize denoised log2-FC and coverage ... #>   >  postHoc selection ... #> 21 rejected hypotheses with at least 0.952380952380952 of true positives.  #- check fold-change of differentially expressed regions ----------------------# DERs <- dds[SummarizedExperiment::mcols(dds)$rejectedHypotheses,] 2^abs(SummarizedExperiment::mcols(DERs)$log2FoldChange) #>  [1]  2.122779  2.034771  2.320207  3.351678  3.807408  4.991526 24.968253 #>  [8]  8.352940  2.833332  7.733332 14.499984 15.714271 17.666617 19.499909 #> [15]  3.318839  3.119999  3.903844  3.730767  4.062498  3.686272  4.174997"},{"path":"/articles/advanced_uses.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Advanced uses of DiffSegR","text":"tutorial explore advanced uses DiffSegR: explore range segmentation models ? select subset segments whose absolute \\(\\log_2\\)-FC passes threshold keeping statistical guarantees true discovery proportion subset ? (Post hoc inference)","code":""},{"path":"/articles/advanced_uses.html","id":"exploring-more-segmentations","dir":"Articles","previous_headings":"","what":"Exploring more segmentations","title":"Advanced uses of DiffSegR","text":"visual inspection, one can disagree segmentation \\(\\log_2\\)-FC proposed DiffSegR. can happen spurious changepoints, resulting -segmentation \\(\\log_2\\)-FC, seems added. case often useful explore several different segmentations order choose suitable hyperparameter \\(\\alpha\\) value. explore reachable segmentations 1 Kmax segments, one can pass segmentNeighborhood = TRUE specify value Kmax segmentation(). step can time consuming. grid search approach also implemented DiffSegR (see gridSearch alphas parameters segmentation()). figures showing path reachable segmentations Kmax segments log2-FC reverse forward strands accessible working directory name all_models_minus.rds all_models_plus.rds. good practice select robust segmentation. Visually equivalent pick elbow curve. example can select \\(\\log(\\alpha)=2.1\\) \\(\\alpha=4.28\\) symbolized red line. Setting alpha=4 segmentation() leads 11 segments reverse strand. Path reachable segmentations 50 segments log2-FC reverse strand. Corresponding alpha values log scale can read X-axis.","code":"SExp <- segmentation(   data                   = data,    nbThreadsFeatureCounts = nb_threads,   outputDirectory        = working_directory,   segmentNeighborhood    = TRUE,   Kmax = 50,   alpha = 4 ) #> changepoint detection on ChrC 71950 78500 plus ... #>   > exploring models using segment neighborhood ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_plus.pdf #> changepoint detection on ChrC 71950 78500 minus ... #>   > exploring models using segment neighborhood ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_minus.pdf #> finished in 0.613906621932983 secs #> counting ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 4                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : counted                                          || #> ||   Min overlapping bases : 1                                                || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84803 ...         || #> ||    Features : 28                                                           || #> ||    Meta-features : 28                                                      || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24260 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21100 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17533 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14070 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #> finished in 0.126092910766602 secs"},{"path":"/articles/advanced_uses.html","id":"post-hoc-inference","dir":"Articles","previous_headings":"","what":"Post hoc inference","title":"Advanced uses of DiffSegR","text":"result DEA correspond user expected, may tend snoop data eventually select subset segments interest. instance common usage define threshold absolute \\(\\log_2\\)-FC per-segment. case DiffSegR declare differentially expressed largest set segments absolute \\(\\log_2\\)-FC > threshold true discovery proportion lower bound choose user (postHoc_tdpLowerBound). post-hoc lower bound obtained controlling joint error rate (JER) using Simes family thresholds (Blanchard et al. 2020). use post hoc inference one specify : decision rule, .e predicate function returns single TRUE FALSE segment applied meets conditions defined predicate. criteria used predicate defined segment SummarizedExperiment::mcols(dds). , predicate = function(x) 2^abs(x$log2FoldChange)>2 ; minimum true discovery proportion among subset segments declared differentially expressed. , postHoc_tdpLowerBound = 0.05 ; significance level test procedure. , postHoc_significanceLevel = 0.05.","code":"dds <- dea(   data                      = data,   SExp                      = SExp,   design                    = ~ condition,   sizeFactors               = rep(1,4),   predicate                 = function(x) 2^abs(x$log2FoldChange)>2,   postHoc_significanceLevel = 0.05,   postHoc_tdpLowerBound     = 0.95 ) #>   > differential expression analysis ... #> renaming the first element in assays to 'counts' #> gene-wise dispersion estimates #> mean-dispersion relationship #> final dispersion estimates #>   >  multiple testing correction ... #>   >  normalize denoised log2-FC and coverage ... #>   >  postHoc selection ... #> 21 rejected hypotheses with at least 0.952380952380952 of true positives.  #- check fold-change of differentially expressed segments ---------------------# DERs <- dds[SummarizedExperiment::mcols(dds)$rejectedHypotheses,] 2^abs(SummarizedExperiment::mcols(DERs)$log2FoldChange) #>  [1]  2.122779  2.034771  2.320207  3.351678  3.807408  4.991526 24.968253 #>  [8]  8.352940  2.833332  7.733332 14.499984 15.714271 17.666617 19.499909 #> [15]  3.318839  3.119999  3.903844  3.730767  4.062498  3.686272  4.174997"},{"path":"/articles/advanced_uses.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Advanced uses of DiffSegR","text":"Blanchard, G., Neuvial, P. Roquain, E. Post hoc confidence bounds false positives using reference families. Ann. Statist 48(3), 1281-1303 (2020). doi.org/10.1214/19-AOS1847.","code":""},{"path":"/articles/introductory_tutorial.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"tutorial use RNA-Seq dataset (SRA046998) generated study differences Arabidopsis thaliana chloroplast RNA metabolism control (wt) null mutant chloroplast-targeted \\(3'\\to5'\\) exoribonuclease polynucleotide phosphorylase (pnp1-1). comparison control plants, mutant overaccumulate RNA fragments mainly located outside annotated genic areas RNA-Seq data extensively validated using molecular techniques (Castandet et al. 2013; Hotto et al. 2015). conditions contain two biological replicates. diluted set reads overlapping positions 71950 78500 chloroplast genome kept minimal dataset example.","code":""},{"path":"/articles/introductory_tutorial.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"setting necessary working environnement loading software, going step classical differential expression analysis along genome DiffSegR: Computation coverages per-base \\(\\log_2\\)-FC bam files ; Summarize differential transcription landscape, .e. () identify segments along genome per-base \\(\\log_2\\)-FC (ii) count reads overlapping ; Use counts measures expression abundance segments differential expression analysis ; Annotate differential expressed regions (DERs) ; Visualize DERs.","code":""},{"path":"/articles/introductory_tutorial.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"First, create working directory host files produced DiffSegR analysis (coverages, results). , save sample information use tutorial text file. practice, one can create working directory write text file hand. sample information file needs include following columns: sample : identifier sample ; condition : identifier condition ; replicate : identifier replicate ; bam : path bam file (.bam) ; coverage : path coverage file (.rds). Note: Coverages computed internally DiffSegR bam files saved rds format location specified user (coverage).","code":"working_directory <- \"./DIFFSEGR_TEST\" dir.create(working_directory, showWarnings = FALSE) #- create sample information table --------------------------------------------# sample_info <- data.frame(   sample    = c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"),   condition = rep(c(\"pnp1_1\", \"wt\"), each = 2),   replicate = rep(1:2,2),   bam       = sapply(     c(\"pnp1_1_1_ChrC_71950_78500.bam\",        \"pnp1_1_2_ChrC_71950_78500.bam\",       \"wt_1_ChrC_71950_78500.bam\",       \"wt_2_ChrC_71950_78500.bam\"     ),     function(bam) system.file(\"extdata\", bam, package = \"DiffSegR\")   ),   coverage  = file.path(     working_directory,     paste0(c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"), \".rds\")   ) ) #- save sample information table ----------------------------------------------#  write.table(   sample_info,    file.path(working_directory, \"sample_info.txt\") ) #- display sample information table -------------------------------------------# knitr::kable(sample_info, row.names = FALSE)"},{"path":"/articles/introductory_tutorial.html","id":"analysis","dir":"Articles","previous_headings":"","what":"Analysis","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"Now, present basic use main functions DiffSegR R package. analysis carried 4 logical cores. parameter can modified user according resources disposal.","code":"library(DiffSegR) nb_threads = 4"},{"path":"/articles/introductory_tutorial.html","id":"step-1-computation-of-coverages-and-per-base-log_2-fc-from-bam-files","dir":"Articles","previous_headings":"Analysis","what":"Step 1: Computation of coverages and per-base \\(\\log_2\\)-FC from bam files","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"loadData(): builds coverages bam files within locus specified user. focus positions 71950 78500 chloroplast genome (ChrC). reads stranded (stranded = TRUE), function builds one coverage profile per-strand replicate compared biological conditions. default heuristic used compute coverages geometric mean 5’ 3’ profiles aligned reads (coverageType = \"average\") ; transforms coverages per-base \\(\\log_2\\)-FC (one strand). reference biological condition specified user set denominator (referenceCondition = \"wt\") ; returns coverages per-base \\(\\log_2\\)-FC list run-length encoding objects. Note: coverages already computed, set fromBam = FALSE load directly specified rds files.","code":"data <- loadData(   sampleInfo   = file.path(working_directory,\"sample_info.txt\"),   locus        = list(     seqid      = \"ChrC\",      chromStart = 71950,      chromEnd   = 78500   ),   referenceCondition = \"wt\",   stranded           = TRUE,   fromBam            = TRUE,   nbThreads          = nb_threads ) #> building coverage profiles ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 4                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 3' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84958 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24249 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21098 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17531 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14066 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 4                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 5' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84958 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24251 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21088 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17520 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14060 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #> building log2-FC per-base ... #> finished in 1.33797335624695 secs  print(data) #> $coverages #> $coverages$plus #> $coverages$plus$pnp1_1_1 #> numeric-Rle of length 6551 with 5255 runs #>   Lengths:       86        1        3        1 ...        1        1       10 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$plus$pnp1_1_2 #> numeric-Rle of length 6551 with 5209 runs #>   Lengths:       89        1        2        1 ...        5        2       30 #>   Values : 0.000000 0.732051 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$plus$wt_1 #> numeric-Rle of length 6551 with 4610 runs #>   Lengths:       46        1       15        1 ...       23        1       14 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$plus$wt_2 #> numeric-Rle of length 6551 with 4601 runs #>   Lengths:       57        1       26        1 ...       22        1        2 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #>  #> $coverages$minus #> $coverages$minus$pnp1_1_1 #> numeric-Rle of length 6551 with 526 runs #>   Lengths:       31        1       68        1 ...        6        1        1 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$minus$pnp1_1_2 #> numeric-Rle of length 6551 with 585 runs #>   Lengths:      406        1       42        1 ...        2        1        1 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$minus$wt_1 #> numeric-Rle of length 6551 with 463 runs #>   Lengths:      427        1       83        1 ...        4        1        2 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$minus$wt_2 #> numeric-Rle of length 6551 with 544 runs #>   Lengths:      458        1       63        1 ...        1       18        1 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.414214 0.000000 0.732051 #>  #>  #>  #> $log2FoldChange #> $log2FoldChange$plus #> numeric-Rle of length 6551 with 6004 runs #>   Lengths:         46          1         10 ...          1          2 #>   Values :  0.0000000 -0.2500000  0.0000000 ...  -0.250000   0.000000 #>  #> $log2FoldChange$minus #> numeric-Rle of length 6551 with 1239 runs #>   Lengths:           31            1           68 ...            1            1 #>   Values :         0.00         0.25         0.00 ...  5.00000e-01 -3.96241e-01 #>  #>  #> $locus #> GRanges object with 1 range and 0 metadata columns: #>       seqnames      ranges strand #>          <Rle>   <IRanges>  <Rle> #>   [1]     ChrC 71950-78500      * #>   ------- #>   seqinfo: 1 sequence from an unspecified genome; no seqlengths #>  #> $stranded #> [1] TRUE #>  #> $sampleInfo #>                                 sample condition replicate #> pnp1_1_1_ChrC_71950_78500.bam pnp1_1_1    pnp1_1         1 #> pnp1_1_2_ChrC_71950_78500.bam pnp1_1_2    pnp1_1         2 #> wt_1_ChrC_71950_78500.bam         wt_1        wt         1 #> wt_2_ChrC_71950_78500.bam         wt_2        wt         2 #>                                                                                                                    bam #> pnp1_1_1_ChrC_71950_78500.bam /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/pnp1_1_1_ChrC_71950_78500.bam #> pnp1_1_2_ChrC_71950_78500.bam /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/pnp1_1_2_ChrC_71950_78500.bam #> wt_1_ChrC_71950_78500.bam         /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/wt_1_ChrC_71950_78500.bam #> wt_2_ChrC_71950_78500.bam         /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/wt_2_ChrC_71950_78500.bam #>                                                   coverage #> pnp1_1_1_ChrC_71950_78500.bam ./DIFFSEGR_TEST/pnp1_1_1.rds #> pnp1_1_2_ChrC_71950_78500.bam ./DIFFSEGR_TEST/pnp1_1_2.rds #> wt_1_ChrC_71950_78500.bam         ./DIFFSEGR_TEST/wt_1.rds #> wt_2_ChrC_71950_78500.bam         ./DIFFSEGR_TEST/wt_2.rds #>  #> $referenceCondition #> [1] \"wt\""},{"path":"/articles/introductory_tutorial.html","id":"setp-2-summarizing-the-differential-transcription-landscape","dir":"Articles","previous_headings":"Analysis","what":"Setp 2: Summarizing the differential transcription landscape","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"segmentation(): calls fpopw::Fpop_w(), changepoint detection mean Gaussian signal approach, per-base \\(\\log_2\\)-FC strands retrieve segments boundaries (changepoints). hyperparameter \\(\\alpha\\) specified user controls number returned segments. number changepoints decreasing function \\(\\alpha\\). default alpha=2. segments stored GenomicRanges object. calls Rsubread::featureCounts() assigns segments mapped reads replicate biological condition. read allowed assigned one feature found overlap one feature. Rsubread::featureCounts() ends building count matrix. returns segments associated count matrix SummarizedExperiment object. positions 71950 78500 chloroplast genome, segmentation() returns 17 segments forward (+) strand 52 segments reverse (-) strand. Segment coordinates associated counts can retrieved using respectively SummarizedExperiment::rowRanges SummarizedExperiment::assay accessors.","code":"SExp <- segmentation(   data                   = data,    nbThreadsFeatureCounts = nb_threads,   outputDirectory        = working_directory ) #> changepoint detection on ChrC 71950 78500 plus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_plus.pdf #> changepoint detection on ChrC 71950 78500 minus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_minus.pdf #> finished in 0.513374090194702 secs #> counting ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 4                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : counted                                          || #> ||   Min overlapping bases : 1                                                || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84958 ...         || #> ||    Features : 69                                                           || #> ||    Meta-features : 69                                                      || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24260 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21100 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17533 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14070 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #> finished in 0.127034187316895 secs #- number of segments found ---------------------------------------------------#  SummarizedExperiment::strand(SExp) #> factor-Rle of length 69 with 2 runs #>   Lengths: 17 52 #>   Values :  +  - #> Levels(3): + - * #- display first five segments ------------------------------------------------# segment_coordinates <- as.data.frame(SummarizedExperiment::rowRanges(SExp)) knitr::kable(segment_coordinates[1:5, colnames(segment_coordinates)%in%c(   \"seqnames\",   \"start\",   \"end\",   \"width\",   \"strand\") ]) #- display counts associated to first five segments ---------------------------# counts <- SummarizedExperiment::assay(SExp) knitr::kable(counts[1:5,])"},{"path":"/articles/introductory_tutorial.html","id":"step-3-differential-expression-analysis-dea","dir":"Articles","previous_headings":"Analysis","what":"Step 3: Differential expression analysis (DEA)","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"dea() function takes input recently built SummarizedExperiment object calls DESeq2 test line, .e. segment, difference expression two compared biological conditions. control resulting p-values using Benjamini–Hochberg procedure level significanceLevel = 1e-2. Note: default sample-specific size factors computed DESeq2. can overwritten user. example, sample-specific size factors weight sizeFactors = rep(1,4). Regions differentially expressed (DERs) set rejectedHypotheses = TRUE. example, dea() returns 39 DERs.","code":"dds <- dea(   data              = data,   SExp              = SExp,   design            = ~ condition,   sizeFactors       = rep(1,4),   significanceLevel = 1e-2 ) #>   > differential expression analysis ... #> renaming the first element in assays to 'counts' #> gene-wise dispersion estimates #> mean-dispersion relationship #> final dispersion estimates #>   >  multiple testing correction ... #>   >  normalize denoised log2-FC and coverage ... #- number of DERs -------------------------------------------------------------# DERs <- dds[SummarizedExperiment::mcols(dds)$rejectedHypotheses,] length(DERs) #> [1] 39 #- display first five DERs by position ----------------------------------------# DERs <- as.data.frame(SummarizedExperiment::rowRanges(DERs)) knitr::kable(DERs[1:5, colnames(DERs)%in%c(   \"seqnames\",   \"start\",   \"end\",   \"width\",   \"strand\",   \"log2FoldChange\",   \"padj\") ])"},{"path":"/articles/introductory_tutorial.html","id":"step-4-annotate-the-ders","dir":"Articles","previous_headings":"Analysis","what":"Step 4: Annotate the DERs","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"annotateNearest() relies user specified annotations gff3 gtf format annotate DERs found DEA. Seven classes labels translate relative positions DER closest annotation(s): antisense; upstream; downstream; inside; overlapping 3’; overlapping 5’; overlapping 5’, 3’.","code":"exons_path <- system.file(  \"extdata\",   \"TAIR10_ChrC_exon.gff3\",   package = \"DiffSegR\" ) annotated_DERs <- annotateNearest(    data        = data,    dds         = dds,    annotations = exons_path,    select      = c(\"seqnames\", \"start\", \"end\", \"width\", \"strand\",       \"description\", \"distance\", \"Parent\", \"log2FoldChange\", \"pvalue\"),    orderBy     = \"pvalue\" ) #>  > loading annotations from /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/TAIR10_ChrC_exon.gff3 ... #>  > annotate differential expressed regions ... knitr::kable(annotated_DERs, row.names = FALSE, digits = 3)"},{"path":"/articles/introductory_tutorial.html","id":"step-5-visualizing-the-ders","dir":"Articles","previous_headings":"Analysis","what":"Step 5: Visualizing the DERs","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"export() saves strands DERs, -DERs, segmentation, coverages log2-FC per-base formats readable (bedGraph, gff3) genome viewers like Integrative Genome Viewer (IGV) (Robison et al. 2011). IGV, export() also creates IGV sessiong xml format allows loading tracks one click. tracks top bottom stand : (log2-Cov plus) mean coverages log scale forward strand biological conditions interest. , blue line red line stand wt pnp1-1 conditions, respectively ; (log2-FC plus) per-base \\(\\log_2\\)-FC pnp1-1 (numerator) wt (denominator) forward strand. straight horizontal line zero indicator. per-base \\(\\log_2\\)-FC zero indicator line, suggests -regulation -regulation pnp1-1 compare wt, respectively. per-base \\(\\log_2\\)-FC displayed changepoints positions (vertical blue lines) mean segment (horizontal blue lines connect two changepoints) ; (DiffSegR plus) results DEA forward strand. -regulated regions appear green. -regulated regions appear purple. -DERs appear grey ; (annotations) features provided user interpetations. Symmetrically, rest tracks correspond data reverse strand. DiffSegR output positions 76,990 78,248 chloroplast genome. session loaded IGV 2.12.3 Linux.","code":"ChrC_path  <- system.file(  \"extdata\",   \"TAIR10_ChrC.fa\",   package = \"DiffSegR\" ) export(  data            = data,  dds             = dds,   outputDirectory = working_directory,  genome          = ChrC_path,  annotation      = exons_path,  select          = c(\"log2FoldChange\", \"pvalue\", \"padj\") )  #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: 'BiocGenerics' #> The following objects are masked from 'package:stats': #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from 'package:base': #>  #>     anyDuplicated, append, as.data.frame, basename, cbind, colnames, #>     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep, #>     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget, #>     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank, #>     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply, #>     union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: 'S4Vectors' #> The following objects are masked from 'package:base': #>  #>     expand.grid, I, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb"},{"path":"/articles/introductory_tutorial.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Tutorial : Transcriptome-Wide Differential Expression Analysis with DiffSegR","text":"Castandet B, Hotto , Fei Z, Stern DB. Strand-specific RNA sequencing uncovers chloroplast ribonuclease functions. FEBS Lett 587(18), 3096-101 (2013). doi:10.1016/j.febslet.2013.08.004. Hotto , Castandet B, Gilet L, Higdon , Condon C, Stern DB. Arabidopsis chloroplast mini-ribonuclease III participates rRNA maturation intron recycling. Plant Cell 27(3), 724-40 (2015). doi:10.1105/tpc.114.134452. James T. Robinson, Helga Thorvaldsdóttir, Wendy Winckler, Mitchell Guttman, Eric S. Lander, Gad Getz, Jill P. Mesirov. Integrative Genomics Viewer. Nature Biotechnology 29, 24–26 (2011). doi:10.1038/nbt.1754.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Arnaud Liehrmann. Author, maintainer. Étienne Delannoy. Author. Benoît Castandet. Author. Guillem Rigaill. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Liehrmann , Delannoy É, Castandet B, Rigaill G (2023). DiffSegR: DiffSegR: RNA-Seq Data Driven Method Differential Expression Analysis using Changepoint Detection. R package version 1.0, https://github.com/aLiehrmann/DiffSegR.","code":"@Manual{,   title = {DiffSegR: DiffSegR: An RNA-Seq Data Driven Method for Differential Expression Analysis using Changepoint Detection},   author = {Arnaud Liehrmann and Étienne Delannoy and Benoît Castandet and Guillem Rigaill},   year = {2023},   note = {R package version 1.0},   url = {https://github.com/aLiehrmann/DiffSegR}, }"},{"path":[]},{"path":"/index.html","id":"what-is-diffsegr-","dir":"","previous_headings":"","what":"What is DiffSegR ?","title":"DiffSegR: An RNA-Seq Data Driven Method for Differential Expression Analysis using Changepoint Detection","text":"DiffSegR R package takes bam files RNA-Seq dataset two biological conditions returns transcriptome-wide expression differences two conditions without using pre-existing annotations (typically genes). motivations method comparison state---art described Liehrmann et al. (2023). Briefly, gaining global picture gene RNA regulations requires detailed knowledge transcriptome along enzymatic RNA-binding activities shape . Hence, several RNA-Seq-based strategies recently developed decipher complexity. However, tools developed count abundance sequencing reads along annotated regions. annotations typically incomplete often lead errors differential expression analysis. context differential expression analysis, regulations genes RNAs result local changes log2 fold change (log2-FC) along genome, .e differential transcription profile. Therefore, one can use multiple changepoint detection algorithm fpop (Maidstone et al. 2017) delineate boundaries differentially expressed regions (DERs) without relying pre-existing annotations. DERs can assessed using, example, negative binomial generalized linear model DESeq2 (Love et al. 2014). DiffSegR R package, identify annotate tool, implements strategy.","code":""},{"path":"/index.html","id":"how-can-i-get-diffsegr-","dir":"","previous_headings":"","what":"How can I get DiffSegR ?","title":"DiffSegR: An RNA-Seq Data Driven Method for Differential Expression Analysis using Changepoint Detection","text":"Make sure remotes installed running install.packages(\"remotes\"), type","code":"remotes::install_github(\"aLiehrmann/DiffSegR\")"},{"path":"/index.html","id":"where-can-i-learn-more","dir":"","previous_headings":"","what":"Where can I learn more?","title":"DiffSegR: An RNA-Seq Data Driven Method for Differential Expression Analysis using Changepoint Detection","text":"See introductory tutorial introduction framework real data. See advanced tutorial examples advanced uses DiffSegR.","code":""},{"path":"/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"DiffSegR: An RNA-Seq Data Driven Method for Differential Expression Analysis using Changepoint Detection","text":"Liehrmann, ., Delannoy, E., Castandet, B. Rigaill, G. DiffSegR: RNA-Seq data driven method differential expression analysis using changepoint detection (2023). add link preprint. Maidstone R, Hocking T, Rigaill G, Fearnhead P. optimal multiple changepoint algorithms large data. Stat Comput 27(2), 519-533 (2017). doi:10.1007/s11222-016-9636-3. Love, M.., Huber, W. & Anders, S. Moderated estimation fold change dispersion RNA-seq data DESeq2. Genome Biol 15, 550 (2014). doi:10.1186/s13059-014-0550-8.","code":""},{"path":"/reference/SD.html","id":null,"dir":"Reference","previous_headings":"","what":"Some robust SD estimators. — SD","title":"Some robust SD estimators. — SD","text":"Robust SD estimators: MAD, weighted MAD, HALL.","code":""},{"path":"/reference/SD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Some robust SD estimators. — SD","text":"","code":"SD(y, w = NULL, method = \"MAD\")"},{"path":"/reference/SD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Some robust SD estimators. — SD","text":"y vector Double. Observations. w vector Double. Weights associated observations. method String. type estimator: \"MAD\" \"wtd_MAD\" \"HALL\"","code":""},{"path":"/reference/SD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Some robust SD estimators. — SD","text":"SD estimation y.","code":""},{"path":"/reference/annotateNearest.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate each provided differentialy expressed region (DER) with its\nclosest annotation(s) — annotateNearest","title":"Annotate each provided differentialy expressed region (DER) with its\nclosest annotation(s) — annotateNearest","text":"annotateNearest() relies user specified annotations gff3 gtf format annotate DERs found DEA. Seven classes labels translate relative positions DER closest annotation(s): antisense ; upstream ; downstream ; inside ; overlapping 3’ ; overlapping 5’ ; overlapping 5’, 3’.","code":""},{"path":"/reference/annotateNearest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate each provided differentialy expressed region (DER) with its\nclosest annotation(s) — annotateNearest","text":"","code":"annotateNearest(   data,   dds,   annotations,   annotationsType = NULL,   orderBy = \"start\",   select = NULL )"},{"path":"/reference/annotateNearest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate each provided differentialy expressed region (DER) with its\nclosest annotation(s) — annotateNearest","text":"data List object returned loadData(). dds DESeqDataSet object returned dea(). annotations String. Path annotation file (gff gtf format). annotationsType vector String. Keep matching annotations. orderBy String. name column returned annotations sorted. select vector String. Keep columns matching names returned Data.frame. default columns mcols(dds) mcols(annotations) kept.","code":""},{"path":"/reference/annotateNearest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Annotate each provided differentialy expressed region (DER) with its\nclosest annotation(s) — annotateNearest","text":"Annotated differentialy expressed regions Data.frame object.","code":""},{"path":"/reference/annotateNearest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate each provided differentialy expressed region (DER) with its\nclosest annotation(s) — annotateNearest","text":"","code":"# Create a working directory for running the example. working_directory <- \"./DIFFSEGR_TEST\" dir.create(working_directory)  # Save sample information in a text file. sample_info <- data.frame(   sample    = c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"),   condition = rep(c(\"pnp1_1\", \"wt\"), each = 2),   replicate = rep(1:2,2),   bam       = sapply(     c(\"pnp1_1_1_ChrC_71950_78500.bam\",        \"pnp1_1_2_ChrC_71950_78500.bam\",       \"wt_1_ChrC_71950_78500.bam\",       \"wt_2_ChrC_71950_78500.bam\"      ),      function(bam) system.file(\"extdata\", bam, package = \"DiffSegR\")   ),   coverage  = file.path(     working_directory,     paste0(c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"), \".rds\")   ) ) write.table(   sample_info,    file.path(working_directory, \"sample_info.txt\") )  # Build coverages and log2-FC per-base. data <- loadData(   sampleInfo         = file.path(working_directory,\"sample_info.txt\"),   locus        = list(     seqid      = \"ChrC\",      chromStart = 71950,      chromEnd   = 78500   ),   referenceCondition = \"wt\",   stranded           = TRUE,   fromBam            = TRUE,   nbThreads          = 1 ) #> building coverage profiles ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 3' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24249 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21098 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17531 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14066 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 5' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24251 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21088 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17520 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14060 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #> building log2-FC per-base ... #> finished in 1.20203614234924 secs  # Summarize the differential landscape. SExp <- segmentation(   data                   = data,    nbThreadsFeatureCounts = 1,   outputDirectory        = working_directory ) #> changepoint detection on ChrC 71950 78500 plus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_plus.pdf #> changepoint detection on ChrC 71950 78500 minus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_minus.pdf #> finished in 0.440589904785156 secs #> counting ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : counted                                          || #> ||   Min overlapping bases : 1                                                || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 69                                                           || #> ||    Meta-features : 69                                                      || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24260 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21100 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17533 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14070 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #> finished in 0.127340316772461 secs  # Differential expression analysis. We control all the resulting  # p-values using a Benjamini–Hochberg procedure at level 0.01. dds <- dea(   data              = data,   SExp              = SExp,   design            = ~ condition,   sizeFactors       = rep(1,4),   significanceLevel = 1e-2 ) #>   > differential expression analysis ... #> renaming the first element in assays to 'counts' #> gene-wise dispersion estimates #> mean-dispersion relationship #> final dispersion estimates #>   >  multiple testing correction ... #>   >  normalize denoised log2-FC and coverage ...  # Annotate each differential expressed region with its closest annotation(s). exons_path <- system.file(   \"extdata\",    \"TAIR10_ChrC_exon.gff3\",    package = \"DiffSegR\" ) annotated_DERs <- annotateNearest(   data        = data,   dds         = dds,   annotations = exons_path,   select      = c(\"seqnames\", \"start\", \"end\", \"width\", \"strand\",      \"description\", \"distance\", \"Parent\", \"log2FoldChange\", \"pvalue\"),   orderBy     = \"pvalue\" ) #>  > loading annotations from /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/TAIR10_ChrC_exon.gff3 ... #>  > annotate differential expressed regions ... print(annotated_DERs[1:10,]) #>     seqnames start   end width strand    description distance      Parent #> 9       ChrC 77964 78112   149      +     downstream      291 ATCG00730.1 #> 101     ChrC 77964 78112   149      +      antisense        0 ATCG00740.1 #> 6       ChrC 76882 77054   173      +       upstream      143 ATCG00730.1 #> 8       ChrC 77740 77963   224      +     downstream       67 ATCG00730.1 #> 91      ChrC 77740 77963   224      +      antisense        0 ATCG00740.1 #> 7       ChrC 77055 77192   138      +       upstream        5 ATCG00730.1 #> 5       ChrC 74939 75471   533      +     downstream       92 ATCG00720.1 #> 10      ChrC 78113 78214   102      +     downstream      440 ATCG00730.1 #> 111     ChrC 78113 78214   102      +      antisense        0 ATCG00740.1 #> 1       ChrC 72256 72402   147      + overlapping 5'        0 ATCG00680.1 #>     log2FoldChange       pvalue #> 9         4.642023 5.054158e-61 #> 101       4.642023 5.054158e-61 #> 6         1.744884 3.876182e-17 #> 8         2.319481 1.036715e-14 #> 91        2.319481 1.036715e-14 #> 7         1.928809 1.934524e-11 #> 5         1.214254 6.502334e-09 #> 10        3.918862 2.166250e-08 #> 111       3.918862 2.166250e-08 #> 1         1.085954 2.525615e-07  # delete working directory  unlink(working_directory, recursive = TRUE)"},{"path":"/reference/dea.html","id":null,"dir":"Reference","previous_headings":"","what":"Differential expression analysis (DEA) — dea","title":"Differential expression analysis (DEA) — dea","text":"dea takes input recently built SummarizedExperiment object calls DESeq2 test line, .e. region, difference expression two compared biological conditions. user can choose control resulting p-values subset interest. first case Benjamini–Hochberg procedure used control False Discovery Rate (FDR). second case, user specifies selection criteria regions, e.g. threshold absolute log2-FC per-regions. , post-hoc procedure used control joint Family wise error Rate (jFWER) selected subset regions.","code":""},{"path":"/reference/dea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Differential expression analysis (DEA) — dea","text":"","code":"dea(   data,   SExp,   design = ~condition,   sizeFactors = NA,   significanceLevel = 0.05,   predicate = NULL,   postHoc_significanceLevel = 0.05,   postHoc_tdpLowerBound = 0.95,   orderBy = \"pvalue\",   verbose = FALSE,   dichotomicSearch = FALSE )"},{"path":"/reference/dea.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Differential expression analysis (DEA) — dea","text":"data List object returned loadData(). SExp SummarizedExperiment object returned segmentation(). design formula object Matrix object. Passed DESeq2::DESeqDataSet. sizeFactors vector Double. Sample-specific size factors. significanceLevel Double. significance cutoff q-values. predicate predicate function returns single TRUE FALSE region applied meets conditions defined predicate. criteria used predicate defined regions mcols(SExp). postHoc_significanceLevel Double. significance level test procedure (see sanssouci::posthocBySimes). postHoc_tdpLowerBound Double. minimum true positive proportion returned set rejected regions. orderBy String. parameter regions sorted post-hoc procedure. verbose Boolean. operations performed displayed (post-hoc) ? dichotomicSearch Boolean. Use speed post-hoc procedure.","code":""},{"path":"/reference/dea.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Differential expression analysis (DEA) — dea","text":"ADESeqDataSet object.","code":""},{"path":"/reference/dea.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Differential expression analysis (DEA) — dea","text":"","code":"# Create a working directory for running the example. working_directory <- \"./DIFFSEGR_TEST\" dir.create(working_directory)  # Save sample information in a text file. sample_info <- data.frame(   sample    = c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"),   condition = rep(c(\"pnp1_1\", \"wt\"), each = 2),   replicate = rep(1:2,2),   bam       = sapply(     c(\"pnp1_1_1_ChrC_71950_78500.bam\",        \"pnp1_1_2_ChrC_71950_78500.bam\",       \"wt_1_ChrC_71950_78500.bam\",       \"wt_2_ChrC_71950_78500.bam\"      ),      function(bam) system.file(\"extdata\", bam, package = \"DiffSegR\")   ),   coverage  = file.path(     working_directory,     paste0(c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"), \".rds\")   ) ) write.table(   sample_info,    file.path(working_directory, \"sample_info.txt\") )  # Build coverages and log2-FC per-base. data <- loadData(   sampleInfo         = file.path(working_directory,\"sample_info.txt\"),   locus        = list(     seqid      = \"ChrC\",      chromStart = 71950,      chromEnd   = 78500   ),   referenceCondition = \"wt\",   stranded           = TRUE,   fromBam            = TRUE,   nbThreads          = 1 ) #> building coverage profiles ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 3' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24249 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21098 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17531 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14066 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 5' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24251 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21088 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17520 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14060 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #> building log2-FC per-base ... #> finished in 0.350280046463013 secs  # Summarize the differential landscape. SExp <- segmentation(   data                   = data,    nbThreadsFeatureCounts = 1,   outputDirectory        = working_directory ) #> changepoint detection on ChrC 71950 78500 plus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_plus.pdf #> changepoint detection on ChrC 71950 78500 minus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_minus.pdf #> finished in 0.154462337493896 secs #> counting ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : counted                                          || #> ||   Min overlapping bases : 1                                                || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 69                                                           || #> ||    Meta-features : 69                                                      || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24260 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21100 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17533 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14070 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #> finished in 0.125716686248779 secs  # Differential expression analysis. We control all the resulting  # p-values using a Benjamini–Hochberg procedure at level 0.01. dds <- dea(   data              = data,   SExp              = SExp,   design            = ~ condition,   sizeFactors       = rep(1,4),   significanceLevel = 1e-2 ) #>   > differential expression analysis ... #> renaming the first element in assays to 'counts' #> gene-wise dispersion estimates #> mean-dispersion relationship #> final dispersion estimates #>   >  multiple testing correction ... #>   >  normalize denoised log2-FC and coverage ...  # first to fifth regions  print(SummarizedExperiment::mcols(dds)[1:5,]) #> DataFrame with 5 rows and 37 columns #>                       modelStart  modelEnd modelMean             featureId #>                        <numeric> <numeric> <numeric>           <character> #> ChrC_71950_72255_plus          1       306 0.0257894 ChrC_71950_72255_plus #> ChrC_72256_72402_plus        307       453 0.6352520 ChrC_72256_72402_plus #> ChrC_72403_74038_plus        454      2089 0.2826332 ChrC_72403_74038_plus #> ChrC_74039_74305_plus       2090      2356 0.0910074 ChrC_74039_74305_plus #> ChrC_74306_74841_plus       2357      2892 0.3207993 ChrC_74306_74841_plus #>                        baseMean    baseVar   allZero dispGeneEst dispGeneIter #>                       <numeric>  <numeric> <logical>   <numeric>    <numeric> #> ChrC_71950_72255_plus    112.50    1085.67     FALSE  0.00000001            5 #> ChrC_72256_72402_plus    483.25   40476.25     FALSE  0.00000001            2 #> ChrC_72403_74038_plus  11037.25 4114258.92     FALSE  0.01999925            2 #> ChrC_74039_74305_plus    122.25     696.25     FALSE  0.00000001           14 #> ChrC_74306_74841_plus   1785.00  236376.67     FALSE  0.02248815            2 #>                         dispFit dispersion  dispIter dispOutlier   dispMAP #>                       <numeric>  <numeric> <integer>   <logical> <numeric> #> ChrC_71950_72255_plus 0.0438822  0.0359269         6       FALSE 0.0359269 #> ChrC_72256_72402_plus 0.0230099  0.0189383         6       FALSE 0.0189383 #> ChrC_72403_74038_plus 0.0169537  0.0175717         9       FALSE 0.0175717 #> ChrC_74039_74305_plus 0.0417124  0.0352381         6       FALSE 0.0352381 #> ChrC_74306_74841_plus 0.0183910  0.0192489         9       FALSE 0.0192489 #>                       Intercept condition_pnp1_1_vs_wt SE_Intercept #>                       <numeric>              <numeric>    <numeric> #> ChrC_71950_72255_plus   6.39232               0.747234     0.223109 #> ChrC_72256_72402_plus   8.27380               1.085954     0.151892 #> ChrC_72403_74038_plus  13.22995               0.375882     0.135628 #> ChrC_74039_74305_plus   6.65821               0.506696     0.216738 #> ChrC_74306_74841_plus  10.45481               0.626337     0.144130 #>                       SE_condition_pnp1_1_vs_wt WaldStatistic_Intercept #>                                       <numeric>               <numeric> #> ChrC_71950_72255_plus                  0.307485                 28.6511 #> ChrC_72256_72402_plus                  0.210628                 54.4714 #> ChrC_72403_74038_plus                  0.191742                 97.5460 #> ChrC_74039_74305_plus                  0.301495                 30.7200 #> ChrC_74306_74841_plus                  0.203189                 72.5374 #>                       WaldStatistic_condition_pnp1_1_vs_wt WaldPvalue_Intercept #>                                                  <numeric>            <numeric> #> ChrC_71950_72255_plus                              2.43015         1.55327e-180 #> ChrC_72256_72402_plus                              5.15579          0.00000e+00 #> ChrC_72403_74038_plus                              1.96035          0.00000e+00 #> ChrC_74039_74305_plus                              1.68061         3.07377e-207 #> ChrC_74306_74841_plus                              3.08253          0.00000e+00 #>                       WaldPvalue_condition_pnp1_1_vs_wt  betaConv  betaIter #>                                               <numeric> <logical> <numeric> #> ChrC_71950_72255_plus                       1.50926e-02      TRUE         2 #> ChrC_72256_72402_plus                       2.52561e-07      TRUE         2 #> ChrC_72403_74038_plus                       4.99545e-02      TRUE         2 #> ChrC_74039_74305_plus                       9.28388e-02      TRUE         2 #> ChrC_74306_74841_plus                       2.05246e-03      TRUE         2 #>                        deviance  maxCooks  baseMean log2FoldChange     lfcSE #>                       <numeric> <logical> <numeric>      <numeric> <numeric> #> ChrC_71950_72255_plus   32.5318        NA    112.50       0.747234  0.307485 #> ChrC_72256_72402_plus   41.1243        NA    483.25       1.085954  0.210628 #> ChrC_72403_74038_plus   67.8832        NA  11037.25       0.375882  0.191742 #> ChrC_74039_74305_plus   33.5075        NA    122.25       0.506696  0.301495 #> ChrC_74306_74841_plus   53.7430        NA   1785.00       0.626337  0.203189 #>                            stat      pvalue        padj log2FoldChangeMean #>                       <numeric>   <numeric>   <numeric>          <numeric> #> ChrC_71950_72255_plus   2.43015 1.50926e-02 2.36679e-02          0.0257894 #> ChrC_72256_72402_plus   5.15579 2.52561e-07 2.48953e-06          0.6352520 #> ChrC_72403_74038_plus   1.96035 4.99545e-02 7.33374e-02          0.2826332 #> ChrC_74039_74305_plus   1.68061 9.28388e-02 1.23190e-01          0.0910074 #> ChrC_74306_74841_plus   3.08253 2.05246e-03 3.72683e-03          0.3207993 #>                       log2RefMean log2OtherMean rejectedHypotheses     group #>                         <numeric>     <numeric>          <logical> <numeric> #> ChrC_71950_72255_plus    0.185676      0.211465              FALSE         0 #> ChrC_72256_72402_plus    0.877737      1.512989               TRUE         1 #> ChrC_72403_74038_plus    1.849847      2.132480              FALSE         2 #> ChrC_74039_74305_plus    0.192321      0.283328              FALSE         2 #> ChrC_74306_74841_plus    1.037875      1.358675               TRUE         3  # delete working directory  unlink(working_directory, recursive = TRUE)"},{"path":"/reference/denoise.html","id":null,"dir":"Reference","previous_headings":"","what":"denoise — denoise","title":"denoise — denoise","text":"denoise() estimates normalized denoised coverages log2-FC per-base.","code":""},{"path":"/reference/denoise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"denoise — denoise","text":"","code":"denoise(dds, data)"},{"path":"/reference/denoise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"denoise — denoise","text":"dds DESeqDataSet object augmented modelStart modelEnd columns. data List object returned loadData().","code":""},{"path":"/reference/denoise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"denoise — denoise","text":"DESeqDataSet augmented log2FCPerBase, log2RefPerBase, log2OtherPerBase columns.","code":""},{"path":"/reference/diffStats.html","id":null,"dir":"Reference","previous_headings":"","what":"Statistics on differentialy expressed regions. — diffStats","title":"Statistics on differentialy expressed regions. — diffStats","text":"diffStats() computes percentage rejected regions / bases.","code":""},{"path":"/reference/diffStats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Statistics on differentialy expressed regions. — diffStats","text":"","code":"diffStats(dds)"},{"path":"/reference/diffStats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Statistics on differentialy expressed regions. — diffStats","text":"dds DESeqDataSet object returned dea().","code":""},{"path":"/reference/export.html","id":null,"dir":"Reference","previous_headings":"","what":"Export DiffSegR results — export","title":"Export DiffSegR results — export","text":"export() saves strands DERs, -DERs, segmentation, coverage profiles log2-FC per-base formats readable (bedGraph,gff3) genome viewers like Integrative Genome Viewer (IGV). IGV, export also creates IGV sessiong xml format allows loading tracks one click.","code":""},{"path":"/reference/export.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export DiffSegR results — export","text":"","code":"export(   data,   dds,   outputDirectory,   genome,   annotations = NA,   igvVersion = \"8\",   select = c() )"},{"path":"/reference/export.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export DiffSegR results — export","text":"data List object returned loadData() dds DESeqDataSet object returned dea(). outputDirectory String. Path output directory. genome String. Path genome reads aligned. annotations String. Path annotation file. igvVersion String. IGV version used xml file. select vector String. Additional information appear region IGV. columns mcols(dds) matching names kept.","code":""},{"path":"/reference/export.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Export DiffSegR results — export","text":"","code":"# Create a working directory for running the example. working_directory <- \"./DIFFSEGR_TEST\" dir.create(working_directory)  # Save sample information in a text file. sample_info <- data.frame(   sample    = c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"),   condition = rep(c(\"pnp1_1\", \"wt\"), each = 2),   replicate = rep(1:2,2),   bam       = sapply(     c(\"pnp1_1_1_ChrC_71950_78500.bam\",        \"pnp1_1_2_ChrC_71950_78500.bam\",       \"wt_1_ChrC_71950_78500.bam\",       \"wt_2_ChrC_71950_78500.bam\"      ),      function(bam) system.file(\"extdata\", bam, package = \"DiffSegR\")   ),   coverage  = file.path(     working_directory,     paste0(c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"), \".rds\")   ) ) write.table(   sample_info,    file.path(working_directory, \"sample_info.txt\") )  # Build coverages and log2-FC per-base. data <- loadData(   sampleInfo   = file.path(working_directory,\"sample_info.txt\"),   locus        = list(     seqid      = \"ChrC\",      chromStart = 71950,      chromEnd   = 78500   ),   referenceCondition = \"wt\",   stranded           = TRUE,   fromBam            = TRUE,   nbThreads          = 1 ) #> building coverage profiles ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 3' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24249 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21098 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17531 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14066 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 5' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24251 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21088 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17520 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14060 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #> building log2-FC per-base ... #> finished in 0.342755794525146 secs  # Summarize the differential landscape. SExp <- segmentation(   data                   = data,    nbThreadsFeatureCounts = 1,   outputDirectory        = working_directory ) #> changepoint detection on ChrC 71950 78500 plus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_plus.pdf #> changepoint detection on ChrC 71950 78500 minus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_minus.pdf #> finished in 0.148231029510498 secs #> counting ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : counted                                          || #> ||   Min overlapping bases : 1                                                || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 69                                                           || #> ||    Meta-features : 69                                                      || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24260 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21100 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17533 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14070 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #> finished in 0.127012968063354 secs  # Differential expression analysis. We control all the resulting  # p-values using a Benjamini–Hochberg procedure at level 0.01. dds <- dea(   data              = data,   SExp              = SExp,   design            = ~ condition,   sizeFactors       = rep(1,4),   significanceLevel = 1e-2 ) #>   > differential expression analysis ... #> renaming the first element in assays to 'counts' #> gene-wise dispersion estimates #> mean-dispersion relationship #> final dispersion estimates #>   >  multiple testing correction ... #>   >  normalize denoised log2-FC and coverage ...  # Visualizing the DERs. exons_path <- system.file(   \"extdata\",    \"TAIR10_ChrC_exon.gff3\",    package = \"DiffSegR\" ) ChrC_path  <- system.file(   \"extdata\",    \"TAIR10_ChrC.fa\",    package = \"DiffSegR\" ) export(   data            = data,   dds             = dds,    outputDirectory = working_directory,   genome          = ChrC_path,   annotations     = exons_path,   select          = c(\"log2FoldChange\", \"pvalue\", \"padj\") )  #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: ‘BiocGenerics’ #> The following objects are masked from ‘package:stats’: #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from ‘package:base’: #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, append, #>     as.data.frame, basename, cbind, colnames, dirname, do.call, #>     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted, #>     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin, #>     pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table, #>     tapply, union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: ‘S4Vectors’ #> The following objects are masked from ‘package:base’: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb  # delete working directory  unlink(working_directory, recursive = TRUE)"},{"path":"/reference/loadData.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the differential transcription profile (log2-FC per-base) — loadData","title":"Compute the differential transcription profile (log2-FC per-base) — loadData","text":"loadData() loads : sample information related RNA-seq experiment ; coverage profile overlapping locus specified user (computed bam files) ; log2-FC per-base (computed coverages).","code":""},{"path":"/reference/loadData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the differential transcription profile (log2-FC per-base) — loadData","text":"","code":"loadData(   sampleInfo,   referenceCondition,   locus,   stranded = TRUE,   strandSpecific = 1,   fromBam = TRUE,   coverageType = \"average\",   readLength = 1,   isPairedEnd = FALSE,   nbThreads = 1,   verbose = TRUE,   featureCountsOtherParams = list() )"},{"path":"/reference/loadData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the differential transcription profile (log2-FC per-base) — loadData","text":"sampleInfo String. Path file sample information. file includes following columns: sample    : identifier sample ; condition : identifier condition ; replicate : identifier replicate ; bam       : path bam file ; coverage  : path coverage file (rds format). referenceCondition String. Reference condition RNA-Seq experiment. reference condition specified user set denominator log2-FC. locus List. list contains coordinates target genomic region: seqid      : String. Chromosome identifier target genomic region ; chromStart : Integer. Start position target genomic region ; chromEnd   : Integer. End position target genomic region. stranded Boolean. Indicate reads stranded . strandSpecific Passed Rsubread::featureCounts(). fromBam Boolean. Indicate coverage profiles computed bam files loaded pre-computed rds files. coverageType String. Select compute coverage profiles: fivePrime  : coverage profiles compute 5' ends reads ; threePrime : coverage profiles compute 3' ends reads ; average    : coverageFactory coverage profile compute average 5' & 3' ends reads ; center     : coverage profiles compute center position reads ; fullLength : coverage profiles compute full length reads. readLength Integer. average length reads bam files. isPairedEnd Passed Rsubread::featureCounts(). nbThreads Passed Rsubread::featureCounts(). verbose Boolean. operations performed displayed ? featureCountsOtherParams List. paramters passed Rsubread::featureCounts().","code":""},{"path":"/reference/loadData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the differential transcription profile (log2-FC per-base) — loadData","text":"List. list contains loaded data: coverage profiles  : List coverages Rle; log2-FC            : Rle Double ; stranded           : see loadData() ; locus              : target genomic region GRanges; sampleInfo         : see loadData() ; referenceCondition : see loadData() ;","code":""},{"path":"/reference/loadData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the differential transcription profile (log2-FC per-base) — loadData","text":"","code":"# Create a working directory for running the example. working_directory <- \"./DIFFSEGR_TEST\" dir.create(working_directory, showWarnings = FALSE)  # Save sample information in a text file. sample_info <- data.frame(   sample    = c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"),   condition = rep(c(\"pnp1_1\", \"wt\"), each = 2),   replicate = rep(1:2,2),   bam       = sapply(     c(\"pnp1_1_1_ChrC_71950_78500.bam\",        \"pnp1_1_2_ChrC_71950_78500.bam\",       \"wt_1_ChrC_71950_78500.bam\",       \"wt_2_ChrC_71950_78500.bam\"      ),      function(bam) system.file(\"extdata\", bam, package = \"DiffSegR\")   ),   coverage  = file.path(     working_directory,     paste0(c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"), \".rds\")   ) ) print(sample_info) #>                                 sample condition replicate #> pnp1_1_1_ChrC_71950_78500.bam pnp1_1_1    pnp1_1         1 #> pnp1_1_2_ChrC_71950_78500.bam pnp1_1_2    pnp1_1         2 #> wt_1_ChrC_71950_78500.bam         wt_1        wt         1 #> wt_2_ChrC_71950_78500.bam         wt_2        wt         2 #>                                                                                                                    bam #> pnp1_1_1_ChrC_71950_78500.bam /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/pnp1_1_1_ChrC_71950_78500.bam #> pnp1_1_2_ChrC_71950_78500.bam /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/pnp1_1_2_ChrC_71950_78500.bam #> wt_1_ChrC_71950_78500.bam         /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/wt_1_ChrC_71950_78500.bam #> wt_2_ChrC_71950_78500.bam         /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/wt_2_ChrC_71950_78500.bam #>                                                   coverage #> pnp1_1_1_ChrC_71950_78500.bam ./DIFFSEGR_TEST/pnp1_1_1.rds #> pnp1_1_2_ChrC_71950_78500.bam ./DIFFSEGR_TEST/pnp1_1_2.rds #> wt_1_ChrC_71950_78500.bam         ./DIFFSEGR_TEST/wt_1.rds #> wt_2_ChrC_71950_78500.bam         ./DIFFSEGR_TEST/wt_2.rds write.table(   sample_info,    file.path(working_directory, \"sample_info.txt\") )  # Build coverages and log2-FC. data <- loadData(   sampleInfo         = file.path(working_directory,\"sample_info.txt\"),   locus        = list(     seqid      = \"ChrC\",      chromStart = 71950,      chromEnd   = 78500   ),   referenceCondition = \"wt\",   stranded           = TRUE,   fromBam            = TRUE,   nbThreads          = 1 ) #> building coverage profiles ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 3' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24249 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21098 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17531 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14066 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 5' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24251 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21088 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17520 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14060 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #> building log2-FC per-base ... #> finished in 0.343965530395508 secs print(data) #> $coverages #> $coverages$plus #> $coverages$plus$pnp1_1_1 #> numeric-Rle of length 6551 with 5255 runs #>   Lengths:       86        1        3        1 ...        1        1       10 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$plus$pnp1_1_2 #> numeric-Rle of length 6551 with 5209 runs #>   Lengths:       89        1        2        1 ...        5        2       30 #>   Values : 0.000000 0.732051 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$plus$wt_1 #> numeric-Rle of length 6551 with 4610 runs #>   Lengths:       46        1       15        1 ...       23        1       14 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$plus$wt_2 #> numeric-Rle of length 6551 with 4601 runs #>   Lengths:       57        1       26        1 ...       22        1        2 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #>  #> $coverages$minus #> $coverages$minus$pnp1_1_1 #> numeric-Rle of length 6551 with 526 runs #>   Lengths:       31        1       68        1 ...        6        1        1 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$minus$pnp1_1_2 #> numeric-Rle of length 6551 with 585 runs #>   Lengths:      406        1       42        1 ...        2        1        1 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$minus$wt_1 #> numeric-Rle of length 6551 with 463 runs #>   Lengths:      427        1       83        1 ...        4        1        2 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.000000 0.414214 0.000000 #>  #> $coverages$minus$wt_2 #> numeric-Rle of length 6551 with 544 runs #>   Lengths:      458        1       63        1 ...        1       18        1 #>   Values : 0.000000 0.414214 0.000000 0.414214 ... 0.414214 0.000000 0.732051 #>  #>  #>  #> $log2FoldChange #> $log2FoldChange$plus #> numeric-Rle of length 6551 with 6004 runs #>   Lengths:         46          1         10 ...          1          2 #>   Values :  0.0000000 -0.2500000  0.0000000 ...  -0.250000   0.000000 #>  #> $log2FoldChange$minus #> numeric-Rle of length 6551 with 1239 runs #>   Lengths:           31            1           68 ...            1            1 #>   Values :         0.00         0.25         0.00 ...  5.00000e-01 -3.96241e-01 #>  #>  #> $locus #> GRanges object with 1 range and 0 metadata columns: #>       seqnames      ranges strand #>          <Rle>   <IRanges>  <Rle> #>   [1]     ChrC 71950-78500      * #>   ------- #>   seqinfo: 1 sequence from an unspecified genome; no seqlengths #>  #> $stranded #> [1] TRUE #>  #> $sampleInfo #>                                 sample condition replicate #> pnp1_1_1_ChrC_71950_78500.bam pnp1_1_1    pnp1_1         1 #> pnp1_1_2_ChrC_71950_78500.bam pnp1_1_2    pnp1_1         2 #> wt_1_ChrC_71950_78500.bam         wt_1        wt         1 #> wt_2_ChrC_71950_78500.bam         wt_2        wt         2 #>                                                                                                                    bam #> pnp1_1_1_ChrC_71950_78500.bam /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/pnp1_1_1_ChrC_71950_78500.bam #> pnp1_1_2_ChrC_71950_78500.bam /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/pnp1_1_2_ChrC_71950_78500.bam #> wt_1_ChrC_71950_78500.bam         /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/wt_1_ChrC_71950_78500.bam #> wt_2_ChrC_71950_78500.bam         /tmp/RtmpAsfQka/temp_libpath149a3731b1b61/DiffSegR/extdata/wt_2_ChrC_71950_78500.bam #>                                                   coverage #> pnp1_1_1_ChrC_71950_78500.bam ./DIFFSEGR_TEST/pnp1_1_1.rds #> pnp1_1_2_ChrC_71950_78500.bam ./DIFFSEGR_TEST/pnp1_1_2.rds #> wt_1_ChrC_71950_78500.bam         ./DIFFSEGR_TEST/wt_1.rds #> wt_2_ChrC_71950_78500.bam         ./DIFFSEGR_TEST/wt_2.rds #>  #> $referenceCondition #> [1] \"wt\" #>   # delete working directory  unlink(working_directory, recursive = TRUE)"},{"path":"/reference/postHocTest.html","id":null,"dir":"Reference","previous_headings":"","what":"postHocTest — postHocTest","title":"postHocTest — postHocTest","text":"Wrapper function around sanssouci::posthocBySimes (Blanchard et al., 2020, doi:10.1214/19-AOS1847) multiple tests correction post-hoc inference.","code":""},{"path":"/reference/postHocTest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"postHocTest — postHocTest","text":"","code":"postHocTest(   SExp,   predicate,   alpha,   tdpLowerBound,   orderBy = \"pvalue\",   verbose = FALSE,   dichotomicSearch = FALSE )"},{"path":"/reference/postHocTest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"postHocTest — postHocTest","text":"SExp object inherits SummarizedExperiment class augmented results differential expression analysis. predicate predicate function returns single TRUE FALSE hypothesis applied meets conditions defined predicate. criteria used predicate defined hypotheses mcols(SExp). alpha Double. significance level (post-hoc) confidence bound type 1 error (see sanssouci::posthocBySimes). tdpLowerBound value minimum true positive rate returned set rejected regions. orderBy String. parameter regions ordered post-hoc procedure. verbose Boolean. operations performed displayed ? dichotomicSearch Boolean. Use speed post-hoc procedure.","code":""},{"path":"/reference/postHocTest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"postHocTest — postHocTest","text":"SummarizedExperiment object returned segmentation() augmented metadata column rejectedHypotheses. rejected regions belong largest set selected regions true positive rate least tdpLowerBound alpha level.","code":""},{"path":"/reference/segmentation.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize the differential transcription landscape — segmentation","title":"Summarize the differential transcription landscape — segmentation","text":"brief, segmentation() () identifies segments homogeneous log2-FC along locus interest (ii) counts reads overlapping . details, segmentation() () starts calling fpopw::Fpop_w() log2-FC profile strands retreive segments boundaries (changepoints). hyperparameter alpha specified user controls number returned segments. Corresponding genomic regions stored GenomicRanges object. (ii) Finally, segmentation() calls Rsubread::featureCounts() assigns regions mapped reads replicate biological condition. default read allowed assigned one region found overlap one region. Rsubread::featureCounts() ends building count matrix. segmentation() ends returning regions associated count matrix SummarizedExperiment object.","code":""},{"path":"/reference/segmentation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize the differential transcription landscape — segmentation","text":"","code":"segmentation(   data,   weightType = \"unweighted\",   modelSelectionType = \"yao\",   featureCountsType = \"fromBam\",   compressed = TRUE,   alpha = 2,   segmentNeighborhood = FALSE,   Kmax = NULL,   verbose = FALSE,   nbThreadsGridSearch = 1,   alphas = NULL,   gridSearch = FALSE,   outputDirectory = \".\",   nbThreadsFeatureCounts = 1,   strandSpecific = 1,   read2pos = NULL,   isPairedEnd = FALSE,   featureCountsOtherParams = list() )"},{"path":"/reference/segmentation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize the differential transcription landscape — segmentation","text":"data List object returned loadData(). weightType String. Select type weights associated log2-FC per-base: unweighted   : observations weight (=1) ; zeroInflated : low counts less weight. modelSelectionType String. Select penalty used FPOP: yao : Yao's penalty alpha*sigma^2*log(n). featureCountsType String. Select summarize counts: fromBam      : bam files using Rsubread::featureCounts ; fromCoverage : coverage profiles. compressed Boolean. Indicate observations compressed (change segmentation results decreases running time). alpha Double. Segmentation hyperparameter used Yao's penalty: alpha*sigma^2*log(n). number changepoints returned fpopw::Fpop_w() decreasing function alpha. segmentNeighborhood Boolean. Indicate weighted pDPA algorithm (Rigaill 2010 2015) used explore space segmentations. Kmax Integer. Segmentations 1 Kmax segments recovered using segment neighborhood. verbose Boolean. operations performed displayed ? nbThreadsGridSearch Integer. Number threads used grid search procedure. alphas vector Double. series alphas used grid search procedure. gridSearch Boolean. Indicate grid search used explore space segmentations. outputDirectory String. Path output directory. nbThreadsFeatureCounts Integer. Passed Rsubread::featureCounts(). strandSpecific Integer. Passed Rsubread::featureCounts(). read2pos Integer. Passed Rsubread::featureCounts(). isPairedEnd Passed Rsubread::featureCounts(). featureCountsOtherParams List. paramters passed Rsubread::featureCounts().","code":""},{"path":"/reference/segmentation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize the differential transcription landscape — segmentation","text":"SummarizedExperiment object contains region boundaries associated count matrix.","code":""},{"path":"/reference/segmentation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize the differential transcription landscape — segmentation","text":"","code":"# Create a working directory for running the example. working_directory <- \"./DIFFSEGR_TEST\" dir.create(working_directory)  # Save sample information in a text file. sample_info <- data.frame(   sample    = c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"),   condition = rep(c(\"pnp1_1\", \"wt\"), each = 2),   replicate = rep(1:2,2),   bam       = sapply(     c(\"pnp1_1_1_ChrC_71950_78500.bam\",        \"pnp1_1_2_ChrC_71950_78500.bam\",       \"wt_1_ChrC_71950_78500.bam\",       \"wt_2_ChrC_71950_78500.bam\"      ),      function(bam) system.file(\"extdata\", bam, package = \"DiffSegR\")   ),   coverage  = file.path(     working_directory,     paste0(c(\"pnp1_1_1\", \"pnp1_1_2\", \"wt_1\", \"wt_2\"), \".rds\")   ) ) write.table(   sample_info,    file.path(working_directory, \"sample_info.txt\") )  # Build coverages and log2-FC. data <- loadData(   sampleInfo         = file.path(working_directory,\"sample_info.txt\"),   locus        = list(     seqid      = \"ChrC\",      chromStart = 71950,      chromEnd   = 78500   ),   referenceCondition = \"wt\",   stranded           = TRUE,   fromBam            = TRUE,   nbThreads          = 1 ) #> building coverage profiles ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 3' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24249 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21098 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17531 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14066 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 5' end                                        || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 13102                                                        || #> ||    Meta-features : 13102                                                   || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24251 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21088 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17520 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14060 (99.9%)                        || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #> building log2-FC per-base ... #> finished in 0.342139482498169 secs  # Summarize the differential landscape. SExp <- segmentation(   data                   = data,    nbThreadsFeatureCounts = 1,   outputDirectory        = working_directory ) #> changepoint detection on ChrC 71950 78500 plus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_plus.pdf #> changepoint detection on ChrC 71950 78500 minus ... #>   > model selection ... #>   > report available in ./DIFFSEGR_TEST/all_models_minus.pdf #> finished in 0.163271903991699 secs #> counting ... #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.10.4 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           pnp1_1_1_ChrC_71950_78500.bam                    || #> ||                           pnp1_1_2_ChrC_71950_78500.bam                    || #> ||                           wt_1_ChrC_71950_78500.bam                        || #> ||                           wt_2_ChrC_71950_78500.bam                        || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : R data.frame                                     || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> || Multi-overlapping reads : counted                                          || #> ||   Min overlapping bases : 1                                                || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file .Rsubread_UserProvidedAnnotation_pid84449 ...         || #> ||    Features : 69                                                           || #> ||    Meta-features : 69                                                      || #> ||    Chromosomes/contigs : 1                                                 || #> ||                                                                            || #> || Process BAM file pnp1_1_1_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 24260                                                || #> ||    Successfully assigned alignments : 24260 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file pnp1_1_2_ChrC_71950_78500.bam...                          || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 21100                                                || #> ||    Successfully assigned alignments : 21100 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_1_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 17533                                                || #> ||    Successfully assigned alignments : 17533 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file wt_2_ChrC_71950_78500.bam...                              || #> ||    Strand specific : stranded                                              || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 14070                                                || #> ||    Successfully assigned alignments : 14070 (100.0%)                       || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #>  #> finished in 0.125227451324463 secs  # In genomic order, first to fifth regions and ... print(SummarizedExperiment::mcols(SExp)[1:5,]) #> DataFrame with 5 rows and 4 columns #>                       modelStart  modelEnd modelMean             featureId #>                        <numeric> <numeric> <numeric>           <character> #> ChrC_71950_72255_plus          1       306 0.0257894 ChrC_71950_72255_plus #> ChrC_72256_72402_plus        307       453 0.6352520 ChrC_72256_72402_plus #> ChrC_72403_74038_plus        454      2089 0.2826332 ChrC_72403_74038_plus #> ChrC_74039_74305_plus       2090      2356 0.0910074 ChrC_74039_74305_plus #> ChrC_74306_74841_plus       2357      2892 0.3207993 ChrC_74306_74841_plus # ... associated counts. print(SummarizedExperiment::assay(SExp)[1:5,]) #>                       pnp1_1_1 pnp1_1_2  wt_1 wt_2 #> ChrC_71950_72255_plus      143      139    84   84 #> ChrC_72256_72402_plus      649      665   326  293 #> ChrC_72403_74038_plus    13203    11731 10849 8366 #> ChrC_74039_74305_plus      155      132    98  104 #> ChrC_74306_74841_plus     2337     1996  1589 1218  # delete working directory  unlink(working_directory, recursive = TRUE)"},{"path":"/news/index.html","id":"diffsegr-10","dir":"Changelog","previous_headings":"","what":"DiffSegR 1.0","title":"DiffSegR 1.0","text":"Fresh start","code":""}]
